<HTML>
<HEAD>
   <TITLE> module s2_graph_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2_graph_mod </H1>
<PRE>module s2_graph_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_error_mod.html">s2_error_mod</A>
    use <A HREF="s2_vect_mod.html">s2_vect_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>

        ! Types
    public type <A HREF="s2_graph_mod.html#type_s2_graph">s2_graph</A>

        ! Subroutines and functions
    public function <A HREF="s2_graph_mod.html#function_s2_graph_init">s2_graph_init</A> (nside, mask) result (graph)
    public subroutine <A HREF="s2_graph_mod.html#subroutine_s2_graph_free">s2_graph_free</A> (graph)
    public subroutine <A HREF="s2_graph_mod.html#subroutine_s2_graph_write_file">s2_graph_write_file</A> (graph, filename_prefix)
    public subroutine <A HREF="s2_graph_mod.html#subroutine_s2_graph_vals">s2_graph_vals</A> (graph, sky, gvals)
    public function <A HREF="s2_graph_mod.html#function_s2_graph_get_nvertices">s2_graph_get_nvertices</A> (graph) result (nvertices)

end module s2_graph_mod
</PRE>
 Provides functionality to create a graph representation of a (potentially
 masked) sky.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk) and A. Stradis

<HR><H2> Description of Types </H2>
<A NAME="type_s2_graph"><H3>s2_graph</H3></A>
<PRE>public type s2_graph
    private
    logical :: init = .false.
    integer :: nside = 0
    integer :: pix_scheme = S2_SKY_NEST
    integer :: nvertices = 0
    integer, allocatable, dimension (:) :: ivertices
    type (s2_vect), allocatable, dimension (:) :: vertices
    real (kind=s2_dp), allocatable, dimension (:,:) :: adj
    real (kind=s2_dp), allocatable, dimension (:) :: deg
    type (s2_sky) :: mask
    logical :: mask_status = .false.
end type s2_graph
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_s2_graph_init"><H3>s2_graph_init</H3></A>
<PRE>public function s2_graph_init (nside, mask) result (graph)
    integer, intent(in) :: nside
    type (s2_sky), optional, intent(inout) :: mask
    type (s2_graph) :: graph
    ! Calls: neighbours_nest, pix2ang_nest, s2_error, s2_sky_map_convert, s2_vect_free
end function s2_graph_init
</PRE>
 Initialie a graph object.
<P>
 Variable:
   <UL>
   <LI>  nside: Healpix resolution of corresponding sphere.
   <LI>  mask: Optimal mask defining pixels to exclude from graph.
   <LI>  graph: Graph object constructed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<A NAME="subroutine_s2_graph_free"><H3>s2_graph_free</H3></A>
<PRE>public subroutine s2_graph_free (graph)
    type (s2_graph), intent(inout) :: graph
    ! Calls: s2_error, s2_sky_free
end subroutine s2_graph_free
</PRE>
 Free all data associated with an initialised graph object and reset all
 other attributes.
<P>
 Variables:
   <UL>
   <LI>  graph: The graph to be freed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<A NAME="subroutine_s2_graph_write_file"><H3>s2_graph_write_file</H3></A>
<PRE>public subroutine s2_graph_write_file (graph, filename_prefix)
    type (s2_graph), intent(inout) :: graph
    character (len=*), intent(in) :: filename_prefix
    ! Calls: s2_error
end subroutine s2_graph_write_file
</PRE>
 Write graph representation to data files.
<P>
 Variables:
   <UL>
   <LI>  graph: The graph to be written to files.
   <LI>  filename_prefix: Prefix of the output filenames.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<A NAME="subroutine_s2_graph_vals"><H3>s2_graph_vals</H3></A>
<PRE>public subroutine s2_graph_vals (graph, sky, gvals)
    type (s2_graph), intent(in) :: graph
    type (s2_sky), intent(inout) :: sky
    real (kind=s2_sp), allocatable, dimension (:) :: gvals
    ! Calls: s2_error, s2_sky_map_convert
end subroutine s2_graph_vals
</PRE>
 Extract the map values of a sky on the graph vertices.
<P>
 Notes:
   <UL>
   <LI>  gvals is allocated herein and must be freed by the calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  graph: Graph representation of sky.
   <LI>  sky: Sky containing map with defined values.
   <LI>  gvals: The graph values, defined on each vertex of the
     graph, that are extracted from the map.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<A NAME="function_s2_graph_get_nvertices"><H3>s2_graph_get_nvertices</H3></A>
<PRE>public function s2_graph_get_nvertices (graph) result (nvertices)
    type (s2_graph), intent(in) :: graph
    integer :: nvertices
    ! Calls: s2_error
end function s2_graph_get_nvertices
</PRE>
 Get nvertices from the passed graph.
<P>
 Variables:
   <UL>
   <LI>  graph: Graph object to get attribute of.
   <LI>  nvertices: Number of vertices in the graph.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
</HTML>
