<HTML>
<HEAD>
   <TITLE> program s2_sky2proj (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program s2_sky2proj </H1>
<PRE>program s2_sky2proj

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2_proj_mod.html">s2_proj_mod</A>
    use <A HREF="s2_error_mod.html">s2_error_mod</A>

        ! Calls
    call parse_options
    call s2_error
    call s2_proj_free
    call s2_proj_get_xmap
    call s2_proj_operator_kernel
    call s2_proj_operator_nearest_neighbour
    call s2_proj_write_image_file
    call s2_sky_conv_space_fovop
    call s2_sky_free

        ! Variables
    character (len=*), parameter :: <A HREF="s2_sky2proj.html#var_map_file">MAP_FILE</A> = 'map'
    character (len=*), parameter :: <A HREF="s2_sky2proj.html#var_alm_file">ALM_FILE</A> = 'alm'
    character (len=*), parameter :: <A HREF="s2_sky2proj.html#var_sky_file">SKY_FILE</A> = 'sky'
    integer :: <A HREF="s2_sky2proj.html#var_file_type">file_type</A> = S2_SKY_FILE_TYPE_ALM
    character (len=*), parameter :: <A HREF="s2_sky2proj.html#var_method_nearest">METHOD_NEAREST</A> = 'nearest'
    character (len=*), parameter :: <A HREF="s2_sky2proj.html#var_method_harmonic">METHOD_HARMONIC</A> = 'harmonic'
    character (len=*), parameter :: <A HREF="s2_sky2proj.html#var_method_kernel">METHOD_KERNEL</A> = 'kernel'
    integer :: <A HREF="s2_sky2proj.html#var_method">method</A> = S2_PROJ_METHOD_NEAREST_NEIGHBOUR
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_filename_in">filename_in</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_filename_out">filename_out</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_file_type_str">file_type_str</A> = ALM_FILE
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_method_str">method_str</A> = METHOD_NEAREST
    real (kind=s2_sp) :: <A HREF="s2_sky2proj.html#var_theta_fov">theta_fov</A>
    integer :: <A HREF="s2_sky2proj.html#var_nside">nside</A> = 0
    integer :: <A HREF="s2_sky2proj.html#var_lmax">lmax</A> = 0
    type (s2_sky) :: <A HREF="s2_sky2proj.html#var_sky">sky</A>
    type (s2_proj) :: <A HREF="s2_sky2proj.html#var_proj">proj</A>
    real (kind=s2_dp) :: <A HREF="s2_sky2proj.html#var_sigma_conv">sigma_conv</A> = 0.02
    real (kind=s2_dp), dimension (1) :: <A HREF="s2_sky2proj.html#var_sigma">sigma</A>
    real (kind=s2_dp) :: <A HREF="s2_sky2proj.html#var_support_theta">support_theta</A>
    logical :: <A HREF="s2_sky2proj.html#var_save_op">save_op</A> = .false.
    logical :: <A HREF="s2_sky2proj.html#var_save_convop">save_convop</A> = .false.
    logical :: <A HREF="s2_sky2proj.html#var_save_xmap">save_xmap</A> = .false.
    logical :: <A HREF="s2_sky2proj.html#var_save_ang">save_ang</A> = .false.
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_filename_op">filename_op</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_filename_convop">filename_convop</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_filename_xmap">filename_xmap</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_sky2proj.html#var_filename_ang">filename_ang</A>
    integer :: <A HREF="s2_sky2proj.html#var_nsphere">nsphere</A>
    integer :: <A HREF="s2_sky2proj.html#var_nop">nop</A>
    integer :: <A HREF="s2_sky2proj.html#var_j">j</A>
    integer :: <A HREF="s2_sky2proj.html#var_fileid">fileid</A>
    integer, allocatable, dimension (:,:) :: <A HREF="s2_sky2proj.html#var_op">op</A>
    real (kind=s2_dp), allocatable, dimension (:,:) :: <A HREF="s2_sky2proj.html#var_op_dp">op_dp</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="s2_sky2proj.html#var_xmap">xmap</A>
    real (kind=s2_dp), allocatable, dimension (:) :: <A HREF="s2_sky2proj.html#var_thetas">thetas</A>
    real (kind=s2_dp), allocatable, dimension (:) :: <A HREF="s2_sky2proj.html#var_phis">phis</A>

        ! Interfaces
    interface <A HREF="s2_sky2proj.html#interface_conv_kernel">conv_kernel</A>

        ! Subroutines and functions
    subroutine <A HREF="s2_sky2proj.html#subroutine_parse_options">parse_options</A> ()

end program s2_sky2proj
</PRE>
 Project a sky onto a planar image.
<P>
 Usage: 
   <UL>
   <LI>  [-help]: Display usage information.
   <LI>  [-inp filename_in]: Name of file containing input sky .
   <LI>  [-file_type file_type_str]: String specifying input file type.
   <LI>  [-out filename_out]: Name of output file for projected image.
   <LI>  [method method]: Projection method to use.
   <LI>  [theta_fov theta_fov]: Field of view (in degrees).
   <LI>  [nside nside]: Healpix nside to use when projecting image (required by 
     some projection methods if not provided in sky object).
   <LI>  [lmax lmax]: Harmonic band-limit to use when projecting image
     (required by some projection methods if not provided in sky object).
   <LI>  [-op_file filename_op (optional)]: File to save matrix representation 
     of projection operator.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)

<HR><H2> Description of Variables </H2>
<A NAME="var_map_file"><H3>MAP_FILE</H3></A>
<PRE>character (len=*), parameter :: MAP_FILE = 'map'
</PRE>
<A NAME="var_alm_file"><H3>ALM_FILE</H3></A>
<PRE>character (len=*), parameter :: ALM_FILE = 'alm'
</PRE>
<A NAME="var_sky_file"><H3>SKY_FILE</H3></A>
<PRE>character (len=*), parameter :: SKY_FILE = 'sky'
</PRE>
<A NAME="var_file_type"><H3>file_type</H3></A>
<PRE>integer :: file_type = S2_SKY_FILE_TYPE_ALM
</PRE>
<A NAME="var_method_nearest"><H3>METHOD_NEAREST</H3></A>
<PRE>character (len=*), parameter :: METHOD_NEAREST = 'nearest'
</PRE>
<A NAME="var_method_harmonic"><H3>METHOD_HARMONIC</H3></A>
<PRE>character (len=*), parameter :: METHOD_HARMONIC = 'harmonic'
</PRE>
<A NAME="var_method_kernel"><H3>METHOD_KERNEL</H3></A>
<PRE>character (len=*), parameter :: METHOD_KERNEL = 'kernel'
</PRE>
<A NAME="var_method"><H3>method</H3></A>
<PRE>integer :: method = S2_PROJ_METHOD_NEAREST_NEIGHBOUR
</PRE>
<A NAME="var_filename_in"><H3>filename_in</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_in
</PRE>
<A NAME="var_filename_out"><H3>filename_out</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_out
</PRE>
<A NAME="var_file_type_str"><H3>file_type_str</H3></A>
<PRE>character (len=S2_STRING_LEN) :: file_type_str = ALM_FILE
</PRE>
<A NAME="var_method_str"><H3>method_str</H3></A>
<PRE>character (len=S2_STRING_LEN) :: method_str = METHOD_NEAREST
</PRE>
<A NAME="var_theta_fov"><H3>theta_fov</H3></A>
<PRE>real (kind=s2_sp) :: theta_fov
</PRE>
<A NAME="var_nside"><H3>nside</H3></A>
<PRE>integer :: nside = 0
</PRE>
<A NAME="var_lmax"><H3>lmax</H3></A>
<PRE>integer :: lmax = 0
</PRE>
<A NAME="var_sky"><H3>sky</H3></A>
<PRE>type (s2_sky) :: sky
</PRE>
<A NAME="var_proj"><H3>proj</H3></A>
<PRE>type (s2_proj) :: proj
</PRE>
<A NAME="var_sigma_conv"><H3>sigma_conv</H3></A>
<PRE>real (kind=s2_dp) :: sigma_conv = 0.02
</PRE>
<A NAME="var_sigma"><H3>sigma</H3></A>
<PRE>real (kind=s2_dp), dimension (1) :: sigma
</PRE>
<A NAME="var_support_theta"><H3>support_theta</H3></A>
<PRE>real (kind=s2_dp) :: support_theta
</PRE>
<A NAME="var_save_op"><H3>save_op</H3></A>
<PRE>logical :: save_op = .false.
</PRE>
<A NAME="var_save_convop"><H3>save_convop</H3></A>
<PRE>logical :: save_convop = .false.
</PRE>
<A NAME="var_save_xmap"><H3>save_xmap</H3></A>
<PRE>logical :: save_xmap = .false.
</PRE>
<A NAME="var_save_ang"><H3>save_ang</H3></A>
<PRE>logical :: save_ang = .false.
</PRE>
<A NAME="var_filename_op"><H3>filename_op</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_op
</PRE>
<A NAME="var_filename_convop"><H3>filename_convop</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_convop
</PRE>
<A NAME="var_filename_xmap"><H3>filename_xmap</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_xmap
</PRE>
<A NAME="var_filename_ang"><H3>filename_ang</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_ang
</PRE>
<A NAME="var_nsphere"><H3>nsphere</H3></A>
<PRE>integer :: nsphere
</PRE>
<A NAME="var_nop"><H3>nop</H3></A>
<PRE>integer :: nop
</PRE>
<A NAME="var_j"><H3>j</H3></A>
<PRE>integer :: j
</PRE>
<A NAME="var_fileid"><H3>fileid</H3></A>
<PRE>integer :: fileid
</PRE>
<A NAME="var_op"><H3>op</H3></A>
<PRE>integer, allocatable, dimension (:,:) :: op
</PRE>
<A NAME="var_op_dp"><H3>op_dp</H3></A>
<PRE>real (kind=s2_dp), allocatable, dimension (:,:) :: op_dp
</PRE>
<A NAME="var_xmap"><H3>xmap</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: xmap
</PRE>
<A NAME="var_thetas"><H3>thetas</H3></A>
<PRE>real (kind=s2_dp), allocatable, dimension (:) :: thetas
</PRE>
<A NAME="var_phis"><H3>phis</H3></A>
<PRE>real (kind=s2_dp), allocatable, dimension (:) :: phis
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_conv_kernel"><H3>conv_kernel</H3></A>
<PRE>interface conv_kernel
    function conv_kernel (theta, param) result (val)
        real (kind=s2_dp), intent(in) :: theta
        real (kind=s2_dp), optional, intent(in), dimension (:) :: param
        real (kind=s2_dp) :: val
    end function conv_kernel
end interface conv_kernel
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_parse_options"><H3>parse_options</H3></A>
<PRE>subroutine parse_options ()
    ! Calls: getArgument
end subroutine parse_options
</PRE>
 Parse the options passed when program called.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
</HTML>
