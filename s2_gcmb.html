<HTML>
<HEAD>
   <TITLE> program s2_gcmb (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program s2_gcmb </H1>
<PRE>program s2_gcmb

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_cmb_mod.html">s2_cmb_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>
    use <A HREF="s2_error_mod.html">s2_error_mod</A>
    use <A HREF="s2_vect_mod.html">s2_vect_mod</A>

        ! Calls
    call parse_options
    call s2_cmb_free
    call s2_error
    call s2_pl_conv
    call s2_pl_free
    call s2_sky_free
    call s2_sky_write_file
    call system_clock

        ! Variables
    type (s2_cmb) :: <A HREF="s2_gcmb.html#var_cmb">cmb</A>
    integer :: <A HREF="s2_gcmb.html#var_nside">nside</A>
    integer :: <A HREF="s2_gcmb.html#var_lmin">lmin</A>
    integer :: <A HREF="s2_gcmb.html#var_lmax">lmax</A>
    integer :: <A HREF="s2_gcmb.html#var_ncomment">ncomment</A>
    integer :: <A HREF="s2_gcmb.html#var_seed">seed</A>
    integer :: <A HREF="s2_gcmb.html#var_fail">fail</A> = 0
    character (len=S2_STRING_LEN) :: <A HREF="s2_gcmb.html#var_filename_cl">filename_cl</A>
    character (len=S2_STRING_LEN) :: <A HREF="s2_gcmb.html#var_filename_out">filename_out</A> = 'out.fits'
    logical :: <A HREF="s2_gcmb.html#var_scale_cl">scale_cl</A> = .true.
    logical :: <A HREF="s2_gcmb.html#var_seed_set">seed_set</A> = .false.
    real (kind=s2_sp) :: <A HREF="s2_gcmb.html#var_noise_var">noise_var</A> = 0.0e0
    real (kind=s2_sp) :: <A HREF="s2_gcmb.html#var_beam_fwhm">beam_fwhm</A> = 0.0e0
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="s2_gcmb.html#var_npl">npl</A>
    logical :: <A HREF="s2_gcmb.html#var_beam_present">beam_present</A> = .false.
    logical :: <A HREF="s2_gcmb.html#var_noise_present">noise_present</A> = .false.
    type (s2_pl) :: <A HREF="s2_gcmb.html#var_beam_pl">beam_pl</A>
    type (s2_pl) :: <A HREF="s2_gcmb.html#var_noise_pl">noise_pl</A>
    type (s2_pl) :: <A HREF="s2_gcmb.html#var_background_pl">background_pl</A>
    type (s2_pl) :: <A HREF="s2_gcmb.html#var_background_pl_tmp">background_pl_tmp</A>
    type (s2_sky) :: <A HREF="s2_gcmb.html#var_cmb_sky">cmb_sky</A>
    character (len=*), parameter :: <A HREF="s2_gcmb.html#var_map_file">MAP_FILE</A> = 'map'
    character (len=*), parameter :: <A HREF="s2_gcmb.html#var_alm_file">ALM_FILE</A> = 'alm'
    character (len=*), parameter :: <A HREF="s2_gcmb.html#var_sky_file">SKY_FILE</A> = 'sky'
    integer :: <A HREF="s2_gcmb.html#var_file_type_out">file_type_out</A> = S2_SKY_FILE_TYPE_MAP
    character (len=S2_STRING_LEN) :: <A HREF="s2_gcmb.html#var_file_type_out_str">file_type_out_str</A> = MAP_FILE
    logical :: <A HREF="s2_gcmb.html#var_compute_map">compute_map</A> = .false.

        ! Subroutines and functions
    subroutine <A HREF="s2_gcmb.html#subroutine_parse_options">parse_options</A> ()

end program s2_gcmb
</PRE>
 Generate a Gaussian CMB realisation from an input power spectrum.
<P>
 Usage: 
   <UL>
   <LI>  [-help]: Display usage information.
   <LI>  [-inp filename_cl]: Name of cl input ascii file.
   <LI>  [-scale_cl scale_cl (logical)]: Logical to specify whether to scale
     the input cl values by 2*pi/(l(l+1)).
   <LI>  [-out filename_out]: Name of output cmb map file.
   <LI>  [-file_type_out file_type_out_str]: String specifying output file type.
   <LI>  [-nside nside]: Healpix nside resolution to generate map for.
   <LI>  [-lmax lmax]: Maximum hamonic l to consider in power spectrum when
     generating map.
   <LI>  [-lmin lmin]: Minimum l of power spectrum contained in input file
     (others are set to zero).  Often this is 2.
   <LI>  [-ncomment ncomment]: Number of comment lines in input file to ignore.
   <LI>  [-seed seed]: Integer seed for random number generator used to
     computed Gaussian realised CMB. If not specified then use system clock.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - July 2005

<HR><H2> Description of Variables </H2>
<A NAME="var_cmb"><H3>cmb</H3></A>
<PRE>type (s2_cmb) :: cmb
</PRE>
<A NAME="var_nside"><H3>nside</H3></A>
<PRE>integer :: nside
</PRE>
<A NAME="var_lmin"><H3>lmin</H3></A>
<PRE>integer :: lmin
</PRE>
<A NAME="var_lmax"><H3>lmax</H3></A>
<PRE>integer :: lmax
</PRE>
<A NAME="var_ncomment"><H3>ncomment</H3></A>
<PRE>integer :: ncomment
</PRE>
<A NAME="var_seed"><H3>seed</H3></A>
<PRE>integer :: seed
</PRE>
<A NAME="var_fail"><H3>fail</H3></A>
<PRE>integer :: fail = 0
</PRE>
<A NAME="var_filename_cl"><H3>filename_cl</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_cl
</PRE>
<A NAME="var_filename_out"><H3>filename_out</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_out = 'out.fits'
</PRE>
<A NAME="var_scale_cl"><H3>scale_cl</H3></A>
<PRE>logical :: scale_cl = .true.
</PRE>
<A NAME="var_seed_set"><H3>seed_set</H3></A>
<PRE>logical :: seed_set = .false.
</PRE>
<A NAME="var_noise_var"><H3>noise_var</H3></A>
<PRE>real (kind=s2_sp) :: noise_var = 0.0e0
</PRE>
<A NAME="var_beam_fwhm"><H3>beam_fwhm</H3></A>
<PRE>real (kind=s2_sp) :: beam_fwhm = 0.0e0
</PRE>
<A NAME="var_npl"><H3>npl</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: npl
</PRE>
<A NAME="var_beam_present"><H3>beam_present</H3></A>
<PRE>logical :: beam_present = .false.
</PRE>
<A NAME="var_noise_present"><H3>noise_present</H3></A>
<PRE>logical :: noise_present = .false.
</PRE>
<A NAME="var_beam_pl"><H3>beam_pl</H3></A>
<PRE>type (s2_pl) :: beam_pl
</PRE>
<A NAME="var_noise_pl"><H3>noise_pl</H3></A>
<PRE>type (s2_pl) :: noise_pl
</PRE>
<A NAME="var_background_pl"><H3>background_pl</H3></A>
<PRE>type (s2_pl) :: background_pl
</PRE>
<A NAME="var_background_pl_tmp"><H3>background_pl_tmp</H3></A>
<PRE>type (s2_pl) :: background_pl_tmp
</PRE>
<A NAME="var_cmb_sky"><H3>cmb_sky</H3></A>
<PRE>type (s2_sky) :: cmb_sky
</PRE>
<A NAME="var_map_file"><H3>MAP_FILE</H3></A>
<PRE>character (len=*), parameter :: MAP_FILE = 'map'
</PRE>
<A NAME="var_alm_file"><H3>ALM_FILE</H3></A>
<PRE>character (len=*), parameter :: ALM_FILE = 'alm'
</PRE>
<A NAME="var_sky_file"><H3>SKY_FILE</H3></A>
<PRE>character (len=*), parameter :: SKY_FILE = 'sky'
</PRE>
<A NAME="var_file_type_out"><H3>file_type_out</H3></A>
<PRE>integer :: file_type_out = S2_SKY_FILE_TYPE_MAP
</PRE>
<A NAME="var_file_type_out_str"><H3>file_type_out_str</H3></A>
<PRE>character (len=S2_STRING_LEN) :: file_type_out_str = MAP_FILE
</PRE>
<A NAME="var_compute_map"><H3>compute_map</H3></A>
<PRE>logical :: compute_map = .false.
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_parse_options"><H3>parse_options</H3></A>
<PRE>subroutine parse_options ()
    ! Calls: getArgument
end subroutine parse_options
</PRE>
 Parse the options passed when program called.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
</HTML>
